services:
  # Web Service (FastAPI)
    - type: web
        name: patent-expiration-api
            env: python
                region: frankfurt
                    plan: free
                        branch: main
                            buildCommand: |
                                  pip install --upgrade pip
                                        pip install -r requirements.txt
                                            startCommand: uvicorn app.main:app --host 0.0.0.0 --port $PORT
                                                healthCheckPath: /api/v1/health
                                                    autoDeploy: true
                                                        envVars:
                                                              - key: PYTHON_VERSION
                                                                      value: 3.11.0
                                                                            - key: DATABASE_URL
                                                                                    fromDatabase:
                                                                                              name: patent-api-db
                                                                                                        property: connectionString
                                                                                                              - key: EPO_CONSUMER_KEY
                                                                                                                      sync: false
                                                                                                                            - key: EPO_CONSUMER_SECRET
                                                                                                                                    sync: false
                                                                                                                                          - key: EPO_BASE_URL
                                                                                                                                                  value: https://ops.epo.org/3.2
                                                                                                                                                        - key: USPTO_API_KEY
                                                                                                                                                                sync: false
                                                                                                                                                                      - key: USPTO_BASE_URL
                                                                                                                                                                              value: https://search.patentsview.org/api/v1
                                                                                                                                                                                    - key: LENS_API_TOKEN
                                                                                                                                                                                            value: ""
                                                                                                                                                                                                  - key: SECRET_KEY
                                                                                                                                                                                                          generateValue: true
                                                                                                                                                                                                                - key: ENVIRONMENT
                                                                                                                                                                                                                        value: production
                                                                                                                                                                                                                              - key: DEBUG
                                                                                                                                                                                                                                      value: false
                                                                                                                                                                                                                                            - key: LOG_LEVEL
                                                                                                                                                                                                                                                    value: INFO
                                                                                                                                                                                                                                                          - key: CACHE_TTL_DAYS
                                                                                                                                                                                                                                                                  value: 30
                                                                                                                                                                                                                                                                        - key: RATE_LIMIT_FREE
                                                                                                                                                                                                                                                                                value: 20
                                                                                                                                                                                                                                                                                      - key: RATE_LIMIT_BASIC
                                                                                                                                                                                                                                                                                              value: 1000
                                                                                                                                                                                                                                                                                                    - key: RATE_LIMIT_PRO
                                                                                                                                                                                                                                                                                                            value: 10000
                                                                                                                                                                                                                                                                                                                  - key: RAPIDAPI_PROXY_SECRET
                                                                                                                                                                                                                                                                                                                          sync: false
                                                                                                                                                                                                                                                                                                                                - key: CORS_ORIGINS
                                                                                                                                                                                                                                                                                                                                        value: '["*"]'

                                                                                                                                                                                                                                                                                                                                        databases:
                                                                                                                                                                                                                                                                                                                                          # PostgreSQL Database
                                                                                                                                                                                                                                                                                                                                            - name: patent-api-db
                                                                                                                                                                                                                                                                                                                                                plan: free
                                                                                                                                                                                                                                                                                                                                                    region: frankfurt
                                                                                                                                                                                                                                                                                                                                                        databaseName: patent_db
                                                                                                                                                                                                                                                                                                                                                            user: patent_user